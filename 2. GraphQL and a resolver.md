# 2. GraphQL and a resolver

Install NPM packages
```bash
npm i @nestjs/graphql @nestjs/apollo graphql apollo-server-express
```

Add module, service, resolver
```bash
nest g module <modulename>
nest g service <modulename>
nest g resolver <modulename>
```

Add GraphQL Module to App Module (code first approach)
```typescript
// app.module.ts
import { join } from 'path';

import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';

import { GraphQLModule } from '@nestjs/graphql';

import { ApolloServerPluginLandingPageLocalDefault } from 'apollo-server-core';

GraphQLModule.forRoot<ApolloDriverConfig>({
  autoSchemaFile: join(process.cwd(), 'src/schema.gql'),
  driver: ApolloDriver,
}),
```

module.entity.ts
```typescript
import { Field, Int, ObjectType } from "@nestjs/graphql";

@ObjectType()
export class Pet {
  @Field( type => Int)
  id: number;

  @Field()
  name: string;

  @Field({nullable: true})
  type?: string;
}
```

module.service.ts
```typescript
import { Pet } from './pet.app';

@Injectable()
export class PetsService {
  async findAll(): Promise<Pet[]> {
    const pet = new Pet();
    pet.id = 1;
    pet.name = "M";

    return [pet]
  }
}
```

module.resolver.ts
```typescript
import { Resolver, Query, Args, Mutation } from '@nestjs/graphql';
import { PetsService } from './pets.service';
import { Pet } from './pet.app';
import { createPetInput } from './dtl/create-pet.input';

@Resolver(of => Pet)
export class PetsResolver {
  constructor(private petsService: PetsService) {}

  @Query(returns => [Pet])
  pets(): Promise<Pet[]> {
    return this.petsService.findAll()
  }
}
```

run: http://localhost:3000/graphql


