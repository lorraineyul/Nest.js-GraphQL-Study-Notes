# 11. Auth Gard

## Auth Gard
poll/auth.guard.ts
```typescript
@Injectable()
export class AuthGuard implements CanActivate {
  canActivate(
    context: ExecutionContext,
  ): boolean {
    const ctx = GqlExecutionContext.create(context);
    const req: Request = ctx.getContext().req;
    // Check if there is a user ID in the session
    if (req.session && req.session.userId) {
      console.log(req.session.userId); // Log the user ID for debugging
      return true;
    }
    return false;
  }
}
```
poll.resolver.ts
```typescript
@Resolver('Poll')
export class PollResolver {
  @Mutation(() => Boolean) 
  @UseGuards(AuthGuard)
  async createPoll() {
    return true
  }
}
```

test mutation createPoll:
```
"originalError": {
          "message": "Forbidden resource",
          "error": "Forbidden",
          "statusCode": 403
        }
```

## Custom Decorator
poll/getUserId.decorator.ts
```typescript
export const GetUserId = createParamDecorator(
  (data, [root, args, ctx, info]) => {
    return ctx.req.session.userId;
  })

```

poll/args/createPollArgs.args.ts
```typescript

```


add decorator and args into poll.resolver.ts

```typescript

```

```typescript

```

```typescript

```

```typescript

```

```typescript

```

```typescript

```

